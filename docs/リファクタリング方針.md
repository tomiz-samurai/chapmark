# Chap.Mark リファクタリング方針

## 共通コンポーネント運用ルール

- 新規共通コンポーネントは必ず`common/`配下の適切なサブディレクトリに追加する
- importは`components/common`経由で統一する
- 責務が明確な場合は`features/`や`layouts/`も活用する
- 大規模化した場合はさらに細分化（例：`timers/SessionTimer.tsx`など）も検討する

## ディレクトリ構成例

```
components/
  common/
    buttons/
    cards/
    displays/
    feedback/
    inputs/
    selectors/
    modals/
    timers/
  features/
  layouts/
  quotes/
  ...
```

## 運用のポイント
- importパスの一元化で保守性・可読性を向上
- サブディレクトリごとに責務を明確化し、肥大化を防ぐ
- 新規追加・リファクタ時は必ず本方針を参照する

## 型定義・サービスAPI運用ルール（2024/xx/xx追記）

### 型定義の一元管理
- すべてのモデル型（Book, Timer, Session, Note, Quote等）は`types/models/`配下で管理し、`types/models/index.ts`で一括exportする
- importは`types/models`からまとめて行う（例: `import { Book, TimerState } from 'types/models'`）
- サービス層・UI層ともに同じBook型等を利用し、独自型やOmit型の乱用を禁止
- DTO型やAPI専用型が必要な場合は`types/dto/`配下に明示的に定義し、`types/dto/index.ts`で一括export

### サービス層API設計ルール
- publicメソッドの引数・戻り値型は必ず明示し、JSDocコメントでAPI仕様（引数・戻り値・副作用）を記載する
- any型や型アサーション（as any）は原則禁止
- 型定義・API仕様に変更があった場合は必ず本ドキュメントを更新する

### 型安全運用の徹底
- 型エラーはCIで検知し、型安全性を担保する
- 型定義・API設計の運用ルールは本ファイルで一元管理し、全員が参照する

---

今後もルール追加・変更があればこのファイルに追記してください。 